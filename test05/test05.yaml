%YAML 1.2
---
#Set up logging
- !ConfigLogging
  stem: test05
  level: TIMING
#Add modules folder to python path
- !PythonPathRequest
  folders: [modules]
#Folder Structure
- !UpdateFolderStructure
  OwnSolutionFile: [solutions, 0, 1, 2]
  SiblingSolutionFile: [solutions, 0]
  postprocfile: [postproc, 0]
- !DumpFolderStructure
  name: test05.dump_folder_structure
  outfile: !SiblingSolutionFile folder_structure.yaml
#id=0001
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0001
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0001.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 3.0
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0001
  mesh_stem: test05-0001
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0001
  mesh: !mesh_hdf5file test05-0001.hdf5
  meshmeta: !meshmetafile test05-0001.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0001
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0001
  name: test05.smol.0001.solve
  mesh: !mesh_hdf5file test05-0001.hdf5
  meshmeta: !meshmetafile test05-0001.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0001/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0001
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0001
  name: test05.smol.0001.extract
  skipsolve: True
  metadata:
    job_id: "0001"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0001/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0002
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0002
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0002.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 3.060606060606061
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0002
  mesh_stem: test05-0002
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0002
  mesh: !mesh_hdf5file test05-0002.hdf5
  meshmeta: !meshmetafile test05-0002.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0002
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0002
  name: test05.smol.0002.solve
  mesh: !mesh_hdf5file test05-0002.hdf5
  meshmeta: !meshmetafile test05-0002.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0002/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0002
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0002
  name: test05.smol.0002.extract
  skipsolve: True
  metadata:
    job_id: "0002"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0002/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0003
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0003
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0003.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 3.121212121212121
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0003
  mesh_stem: test05-0003
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0003
  mesh: !mesh_hdf5file test05-0003.hdf5
  meshmeta: !meshmetafile test05-0003.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0003
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0003
  name: test05.smol.0003.solve
  mesh: !mesh_hdf5file test05-0003.hdf5
  meshmeta: !meshmetafile test05-0003.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0003/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0003
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0003
  name: test05.smol.0003.extract
  skipsolve: True
  metadata:
    job_id: "0003"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0003/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0004
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0004
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0004.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 3.1818181818181817
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0004
  mesh_stem: test05-0004
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0004
  mesh: !mesh_hdf5file test05-0004.hdf5
  meshmeta: !meshmetafile test05-0004.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0004
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0004
  name: test05.smol.0004.solve
  mesh: !mesh_hdf5file test05-0004.hdf5
  meshmeta: !meshmetafile test05-0004.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0004/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0004
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0004
  name: test05.smol.0004.extract
  skipsolve: True
  metadata:
    job_id: "0004"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0004/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0005
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0005
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0005.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 3.2424242424242418
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0005
  mesh_stem: test05-0005
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0005
  mesh: !mesh_hdf5file test05-0005.hdf5
  meshmeta: !meshmetafile test05-0005.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0005
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0005
  name: test05.smol.0005.solve
  mesh: !mesh_hdf5file test05-0005.hdf5
  meshmeta: !meshmetafile test05-0005.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0005/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0005
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0005
  name: test05.smol.0005.extract
  skipsolve: True
  metadata:
    job_id: "0005"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0005/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0006
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0006
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0006.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 3.303030303030303
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0006
  mesh_stem: test05-0006
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0006
  mesh: !mesh_hdf5file test05-0006.hdf5
  meshmeta: !meshmetafile test05-0006.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0006
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0006
  name: test05.smol.0006.solve
  mesh: !mesh_hdf5file test05-0006.hdf5
  meshmeta: !meshmetafile test05-0006.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0006/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0006
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0006
  name: test05.smol.0006.extract
  skipsolve: True
  metadata:
    job_id: "0006"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0006/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0007
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0007
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0007.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 3.363636363636364
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0007
  mesh_stem: test05-0007
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0007
  mesh: !mesh_hdf5file test05-0007.hdf5
  meshmeta: !meshmetafile test05-0007.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0007
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0007
  name: test05.smol.0007.solve
  mesh: !mesh_hdf5file test05-0007.hdf5
  meshmeta: !meshmetafile test05-0007.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0007/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0007
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0007
  name: test05.smol.0007.extract
  skipsolve: True
  metadata:
    job_id: "0007"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0007/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0008
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0008
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0008.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 3.4242424242424243
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0008
  mesh_stem: test05-0008
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0008
  mesh: !mesh_hdf5file test05-0008.hdf5
  meshmeta: !meshmetafile test05-0008.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0008
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0008
  name: test05.smol.0008.solve
  mesh: !mesh_hdf5file test05-0008.hdf5
  meshmeta: !meshmetafile test05-0008.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0008/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0008
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0008
  name: test05.smol.0008.extract
  skipsolve: True
  metadata:
    job_id: "0008"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0008/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0009
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0009
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0009.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 3.484848484848485
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0009
  mesh_stem: test05-0009
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0009
  mesh: !mesh_hdf5file test05-0009.hdf5
  meshmeta: !meshmetafile test05-0009.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0009
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0009
  name: test05.smol.0009.solve
  mesh: !mesh_hdf5file test05-0009.hdf5
  meshmeta: !meshmetafile test05-0009.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0009/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0009
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0009
  name: test05.smol.0009.extract
  skipsolve: True
  metadata:
    job_id: "0009"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0009/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0010
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0010
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0010.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 3.5454545454545454
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0010
  mesh_stem: test05-0010
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0010
  mesh: !mesh_hdf5file test05-0010.hdf5
  meshmeta: !meshmetafile test05-0010.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0010
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0010
  name: test05.smol.0010.solve
  mesh: !mesh_hdf5file test05-0010.hdf5
  meshmeta: !meshmetafile test05-0010.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0010/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0010
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0010
  name: test05.smol.0010.extract
  skipsolve: True
  metadata:
    job_id: "0010"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0010/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0011
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0011
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0011.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 3.6060606060606064
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0011
  mesh_stem: test05-0011
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0011
  mesh: !mesh_hdf5file test05-0011.hdf5
  meshmeta: !meshmetafile test05-0011.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0011
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0011
  name: test05.smol.0011.solve
  mesh: !mesh_hdf5file test05-0011.hdf5
  meshmeta: !meshmetafile test05-0011.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0011/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0011
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0011
  name: test05.smol.0011.extract
  skipsolve: True
  metadata:
    job_id: "0011"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0011/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0012
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0012
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0012.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 3.666666666666667
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0012
  mesh_stem: test05-0012
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0012
  mesh: !mesh_hdf5file test05-0012.hdf5
  meshmeta: !meshmetafile test05-0012.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0012
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0012
  name: test05.smol.0012.solve
  mesh: !mesh_hdf5file test05-0012.hdf5
  meshmeta: !meshmetafile test05-0012.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0012/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0012
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0012
  name: test05.smol.0012.extract
  skipsolve: True
  metadata:
    job_id: "0012"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0012/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0013
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0013
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0013.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 3.727272727272728
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0013
  mesh_stem: test05-0013
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0013
  mesh: !mesh_hdf5file test05-0013.hdf5
  meshmeta: !meshmetafile test05-0013.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0013
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0013
  name: test05.smol.0013.solve
  mesh: !mesh_hdf5file test05-0013.hdf5
  meshmeta: !meshmetafile test05-0013.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0013/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0013
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0013
  name: test05.smol.0013.extract
  skipsolve: True
  metadata:
    job_id: "0013"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0013/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0014
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0014
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0014.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 3.787878787878788
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0014
  mesh_stem: test05-0014
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0014
  mesh: !mesh_hdf5file test05-0014.hdf5
  meshmeta: !meshmetafile test05-0014.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0014
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0014
  name: test05.smol.0014.solve
  mesh: !mesh_hdf5file test05-0014.hdf5
  meshmeta: !meshmetafile test05-0014.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0014/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0014
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0014
  name: test05.smol.0014.extract
  skipsolve: True
  metadata:
    job_id: "0014"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0014/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0015
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0015
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0015.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 3.8484848484848486
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0015
  mesh_stem: test05-0015
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0015
  mesh: !mesh_hdf5file test05-0015.hdf5
  meshmeta: !meshmetafile test05-0015.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0015
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0015
  name: test05.smol.0015.solve
  mesh: !mesh_hdf5file test05-0015.hdf5
  meshmeta: !meshmetafile test05-0015.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0015/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0015
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0015
  name: test05.smol.0015.extract
  skipsolve: True
  metadata:
    job_id: "0015"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0015/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0016
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0016
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0016.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 3.9090909090909087
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0016
  mesh_stem: test05-0016
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0016
  mesh: !mesh_hdf5file test05-0016.hdf5
  meshmeta: !meshmetafile test05-0016.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0016
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0016
  name: test05.smol.0016.solve
  mesh: !mesh_hdf5file test05-0016.hdf5
  meshmeta: !meshmetafile test05-0016.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0016/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0016
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0016
  name: test05.smol.0016.extract
  skipsolve: True
  metadata:
    job_id: "0016"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0016/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0017
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0017
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0017.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 3.9696969696969697
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0017
  mesh_stem: test05-0017
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0017
  mesh: !mesh_hdf5file test05-0017.hdf5
  meshmeta: !meshmetafile test05-0017.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0017
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0017
  name: test05.smol.0017.solve
  mesh: !mesh_hdf5file test05-0017.hdf5
  meshmeta: !meshmetafile test05-0017.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0017/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0017
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0017
  name: test05.smol.0017.extract
  skipsolve: True
  metadata:
    job_id: "0017"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0017/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0018
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0018
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0018.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 4.03030303030303
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0018
  mesh_stem: test05-0018
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0018
  mesh: !mesh_hdf5file test05-0018.hdf5
  meshmeta: !meshmetafile test05-0018.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0018
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0018
  name: test05.smol.0018.solve
  mesh: !mesh_hdf5file test05-0018.hdf5
  meshmeta: !meshmetafile test05-0018.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0018/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0018
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0018
  name: test05.smol.0018.extract
  skipsolve: True
  metadata:
    job_id: "0018"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0018/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0019
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0019
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0019.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 4.090909090909091
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0019
  mesh_stem: test05-0019
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0019
  mesh: !mesh_hdf5file test05-0019.hdf5
  meshmeta: !meshmetafile test05-0019.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0019
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0019
  name: test05.smol.0019.solve
  mesh: !mesh_hdf5file test05-0019.hdf5
  meshmeta: !meshmetafile test05-0019.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0019/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0019
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0019
  name: test05.smol.0019.extract
  skipsolve: True
  metadata:
    job_id: "0019"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0019/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0020
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0020
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0020.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 4.151515151515151
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0020
  mesh_stem: test05-0020
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0020
  mesh: !mesh_hdf5file test05-0020.hdf5
  meshmeta: !meshmetafile test05-0020.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0020
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0020
  name: test05.smol.0020.solve
  mesh: !mesh_hdf5file test05-0020.hdf5
  meshmeta: !meshmetafile test05-0020.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0020/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0020
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0020
  name: test05.smol.0020.extract
  skipsolve: True
  metadata:
    job_id: "0020"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0020/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0021
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0021
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0021.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 4.212121212121212
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0021
  mesh_stem: test05-0021
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0021
  mesh: !mesh_hdf5file test05-0021.hdf5
  meshmeta: !meshmetafile test05-0021.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0021
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0021
  name: test05.smol.0021.solve
  mesh: !mesh_hdf5file test05-0021.hdf5
  meshmeta: !meshmetafile test05-0021.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0021/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0021
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0021
  name: test05.smol.0021.extract
  skipsolve: True
  metadata:
    job_id: "0021"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0021/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0022
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0022
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0022.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 4.2727272727272725
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0022
  mesh_stem: test05-0022
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0022
  mesh: !mesh_hdf5file test05-0022.hdf5
  meshmeta: !meshmetafile test05-0022.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0022
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0022
  name: test05.smol.0022.solve
  mesh: !mesh_hdf5file test05-0022.hdf5
  meshmeta: !meshmetafile test05-0022.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0022/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0022
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0022
  name: test05.smol.0022.extract
  skipsolve: True
  metadata:
    job_id: "0022"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0022/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0023
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0023
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0023.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 4.333333333333334
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0023
  mesh_stem: test05-0023
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0023
  mesh: !mesh_hdf5file test05-0023.hdf5
  meshmeta: !meshmetafile test05-0023.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0023
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0023
  name: test05.smol.0023.solve
  mesh: !mesh_hdf5file test05-0023.hdf5
  meshmeta: !meshmetafile test05-0023.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0023/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0023
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0023
  name: test05.smol.0023.extract
  skipsolve: True
  metadata:
    job_id: "0023"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0023/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0024
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0024
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0024.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 4.3939393939393945
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0024
  mesh_stem: test05-0024
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0024
  mesh: !mesh_hdf5file test05-0024.hdf5
  meshmeta: !meshmetafile test05-0024.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0024
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0024
  name: test05.smol.0024.solve
  mesh: !mesh_hdf5file test05-0024.hdf5
  meshmeta: !meshmetafile test05-0024.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0024/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0024
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0024
  name: test05.smol.0024.extract
  skipsolve: True
  metadata:
    job_id: "0024"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0024/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0025
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0025
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0025.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 4.454545454545455
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0025
  mesh_stem: test05-0025
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0025
  mesh: !mesh_hdf5file test05-0025.hdf5
  meshmeta: !meshmetafile test05-0025.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0025
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0025
  name: test05.smol.0025.solve
  mesh: !mesh_hdf5file test05-0025.hdf5
  meshmeta: !meshmetafile test05-0025.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0025/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0025
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0025
  name: test05.smol.0025.extract
  skipsolve: True
  metadata:
    job_id: "0025"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0025/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0026
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0026
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0026.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 4.5151515151515165
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0026
  mesh_stem: test05-0026
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0026
  mesh: !mesh_hdf5file test05-0026.hdf5
  meshmeta: !meshmetafile test05-0026.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0026
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0026
  name: test05.smol.0026.solve
  mesh: !mesh_hdf5file test05-0026.hdf5
  meshmeta: !meshmetafile test05-0026.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0026/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0026
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0026
  name: test05.smol.0026.extract
  skipsolve: True
  metadata:
    job_id: "0026"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0026/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0027
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0027
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0027.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 4.575757575757576
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0027
  mesh_stem: test05-0027
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0027
  mesh: !mesh_hdf5file test05-0027.hdf5
  meshmeta: !meshmetafile test05-0027.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0027
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0027
  name: test05.smol.0027.solve
  mesh: !mesh_hdf5file test05-0027.hdf5
  meshmeta: !meshmetafile test05-0027.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0027/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0027
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0027
  name: test05.smol.0027.extract
  skipsolve: True
  metadata:
    job_id: "0027"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0027/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0028
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0028
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0028.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 4.636363636363637
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0028
  mesh_stem: test05-0028
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0028
  mesh: !mesh_hdf5file test05-0028.hdf5
  meshmeta: !meshmetafile test05-0028.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0028
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0028
  name: test05.smol.0028.solve
  mesh: !mesh_hdf5file test05-0028.hdf5
  meshmeta: !meshmetafile test05-0028.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0028/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0028
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0028
  name: test05.smol.0028.extract
  skipsolve: True
  metadata:
    job_id: "0028"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0028/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0029
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0029
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0029.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 4.696969696969697
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0029
  mesh_stem: test05-0029
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0029
  mesh: !mesh_hdf5file test05-0029.hdf5
  meshmeta: !meshmetafile test05-0029.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0029
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0029
  name: test05.smol.0029.solve
  mesh: !mesh_hdf5file test05-0029.hdf5
  meshmeta: !meshmetafile test05-0029.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0029/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0029
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0029
  name: test05.smol.0029.extract
  skipsolve: True
  metadata:
    job_id: "0029"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0029/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0030
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0030
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0030.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 4.757575757575758
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0030
  mesh_stem: test05-0030
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0030
  mesh: !mesh_hdf5file test05-0030.hdf5
  meshmeta: !meshmetafile test05-0030.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0030
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0030
  name: test05.smol.0030.solve
  mesh: !mesh_hdf5file test05-0030.hdf5
  meshmeta: !meshmetafile test05-0030.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0030/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0030
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0030
  name: test05.smol.0030.extract
  skipsolve: True
  metadata:
    job_id: "0030"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0030/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0031
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0031
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0031.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 4.818181818181818
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0031
  mesh_stem: test05-0031
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0031
  mesh: !mesh_hdf5file test05-0031.hdf5
  meshmeta: !meshmetafile test05-0031.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0031
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0031
  name: test05.smol.0031.solve
  mesh: !mesh_hdf5file test05-0031.hdf5
  meshmeta: !meshmetafile test05-0031.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0031/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0031
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0031
  name: test05.smol.0031.extract
  skipsolve: True
  metadata:
    job_id: "0031"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0031/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0032
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0032
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0032.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 4.878787878787879
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0032
  mesh_stem: test05-0032
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0032
  mesh: !mesh_hdf5file test05-0032.hdf5
  meshmeta: !meshmetafile test05-0032.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0032
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0032
  name: test05.smol.0032.solve
  mesh: !mesh_hdf5file test05-0032.hdf5
  meshmeta: !meshmetafile test05-0032.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0032/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0032
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0032
  name: test05.smol.0032.extract
  skipsolve: True
  metadata:
    job_id: "0032"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0032/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0033
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0033
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0033.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 4.9393939393939394
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0033
  mesh_stem: test05-0033
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0033
  mesh: !mesh_hdf5file test05-0033.hdf5
  meshmeta: !meshmetafile test05-0033.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0033
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0033
  name: test05.smol.0033.solve
  mesh: !mesh_hdf5file test05-0033.hdf5
  meshmeta: !meshmetafile test05-0033.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0033/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0033
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0033
  name: test05.smol.0033.extract
  skipsolve: True
  metadata:
    job_id: "0033"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0033/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0034
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0034
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0034.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 5.0
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0034
  mesh_stem: test05-0034
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0034
  mesh: !mesh_hdf5file test05-0034.hdf5
  meshmeta: !meshmetafile test05-0034.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0034
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0034
  name: test05.smol.0034.solve
  mesh: !mesh_hdf5file test05-0034.hdf5
  meshmeta: !meshmetafile test05-0034.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0034/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0034
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0034
  name: test05.smol.0034.extract
  skipsolve: True
  metadata:
    job_id: "0034"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0034/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0035
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0035
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0035.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 5.0606060606060606
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0035
  mesh_stem: test05-0035
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0035
  mesh: !mesh_hdf5file test05-0035.hdf5
  meshmeta: !meshmetafile test05-0035.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0035
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0035
  name: test05.smol.0035.solve
  mesh: !mesh_hdf5file test05-0035.hdf5
  meshmeta: !meshmetafile test05-0035.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0035/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0035
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0035
  name: test05.smol.0035.extract
  skipsolve: True
  metadata:
    job_id: "0035"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0035/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0036
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0036
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0036.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 5.121212121212121
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0036
  mesh_stem: test05-0036
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0036
  mesh: !mesh_hdf5file test05-0036.hdf5
  meshmeta: !meshmetafile test05-0036.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0036
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0036
  name: test05.smol.0036.solve
  mesh: !mesh_hdf5file test05-0036.hdf5
  meshmeta: !meshmetafile test05-0036.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0036/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0036
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0036
  name: test05.smol.0036.extract
  skipsolve: True
  metadata:
    job_id: "0036"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0036/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0037
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0037
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0037.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 5.181818181818182
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0037
  mesh_stem: test05-0037
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0037
  mesh: !mesh_hdf5file test05-0037.hdf5
  meshmeta: !meshmetafile test05-0037.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0037
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0037
  name: test05.smol.0037.solve
  mesh: !mesh_hdf5file test05-0037.hdf5
  meshmeta: !meshmetafile test05-0037.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0037/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0037
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0037
  name: test05.smol.0037.extract
  skipsolve: True
  metadata:
    job_id: "0037"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0037/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0038
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0038
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0038.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 5.242424242424242
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0038
  mesh_stem: test05-0038
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0038
  mesh: !mesh_hdf5file test05-0038.hdf5
  meshmeta: !meshmetafile test05-0038.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0038
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0038
  name: test05.smol.0038.solve
  mesh: !mesh_hdf5file test05-0038.hdf5
  meshmeta: !meshmetafile test05-0038.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0038/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0038
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0038
  name: test05.smol.0038.extract
  skipsolve: True
  metadata:
    job_id: "0038"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0038/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0039
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0039
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0039.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 5.303030303030303
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0039
  mesh_stem: test05-0039
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0039
  mesh: !mesh_hdf5file test05-0039.hdf5
  meshmeta: !meshmetafile test05-0039.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0039
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0039
  name: test05.smol.0039.solve
  mesh: !mesh_hdf5file test05-0039.hdf5
  meshmeta: !meshmetafile test05-0039.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0039/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0039
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0039
  name: test05.smol.0039.extract
  skipsolve: True
  metadata:
    job_id: "0039"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0039/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0040
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0040
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0040.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 5.363636363636363
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0040
  mesh_stem: test05-0040
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0040
  mesh: !mesh_hdf5file test05-0040.hdf5
  meshmeta: !meshmetafile test05-0040.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0040
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0040
  name: test05.smol.0040.solve
  mesh: !mesh_hdf5file test05-0040.hdf5
  meshmeta: !meshmetafile test05-0040.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0040/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0040
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0040
  name: test05.smol.0040.extract
  skipsolve: True
  metadata:
    job_id: "0040"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0040/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0041
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0041
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0041.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 5.424242424242424
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0041
  mesh_stem: test05-0041
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0041
  mesh: !mesh_hdf5file test05-0041.hdf5
  meshmeta: !meshmetafile test05-0041.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0041
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0041
  name: test05.smol.0041.solve
  mesh: !mesh_hdf5file test05-0041.hdf5
  meshmeta: !meshmetafile test05-0041.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0041/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0041
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0041
  name: test05.smol.0041.extract
  skipsolve: True
  metadata:
    job_id: "0041"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0041/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0042
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0042
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0042.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 5.4848484848484835
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0042
  mesh_stem: test05-0042
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0042
  mesh: !mesh_hdf5file test05-0042.hdf5
  meshmeta: !meshmetafile test05-0042.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0042
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0042
  name: test05.smol.0042.solve
  mesh: !mesh_hdf5file test05-0042.hdf5
  meshmeta: !meshmetafile test05-0042.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0042/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0042
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0042
  name: test05.smol.0042.extract
  skipsolve: True
  metadata:
    job_id: "0042"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0042/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0043
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0043
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0043.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 5.545454545454545
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0043
  mesh_stem: test05-0043
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0043
  mesh: !mesh_hdf5file test05-0043.hdf5
  meshmeta: !meshmetafile test05-0043.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0043
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0043
  name: test05.smol.0043.solve
  mesh: !mesh_hdf5file test05-0043.hdf5
  meshmeta: !meshmetafile test05-0043.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0043/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0043
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0043
  name: test05.smol.0043.extract
  skipsolve: True
  metadata:
    job_id: "0043"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0043/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0044
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0044
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0044.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 5.6060606060606055
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0044
  mesh_stem: test05-0044
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0044
  mesh: !mesh_hdf5file test05-0044.hdf5
  meshmeta: !meshmetafile test05-0044.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0044
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0044
  name: test05.smol.0044.solve
  mesh: !mesh_hdf5file test05-0044.hdf5
  meshmeta: !meshmetafile test05-0044.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0044/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0044
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0044
  name: test05.smol.0044.extract
  skipsolve: True
  metadata:
    job_id: "0044"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0044/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0045
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0045
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0045.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 5.666666666666668
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0045
  mesh_stem: test05-0045
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0045
  mesh: !mesh_hdf5file test05-0045.hdf5
  meshmeta: !meshmetafile test05-0045.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0045
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0045
  name: test05.smol.0045.solve
  mesh: !mesh_hdf5file test05-0045.hdf5
  meshmeta: !meshmetafile test05-0045.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0045/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0045
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0045
  name: test05.smol.0045.extract
  skipsolve: True
  metadata:
    job_id: "0045"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0045/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0046
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0046
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0046.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 5.727272727272728
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0046
  mesh_stem: test05-0046
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0046
  mesh: !mesh_hdf5file test05-0046.hdf5
  meshmeta: !meshmetafile test05-0046.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0046
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0046
  name: test05.smol.0046.solve
  mesh: !mesh_hdf5file test05-0046.hdf5
  meshmeta: !meshmetafile test05-0046.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0046/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0046
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0046
  name: test05.smol.0046.extract
  skipsolve: True
  metadata:
    job_id: "0046"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0046/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0047
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0047
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0047.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 5.787878787878787
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0047
  mesh_stem: test05-0047
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0047
  mesh: !mesh_hdf5file test05-0047.hdf5
  meshmeta: !meshmetafile test05-0047.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0047
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0047
  name: test05.smol.0047.solve
  mesh: !mesh_hdf5file test05-0047.hdf5
  meshmeta: !meshmetafile test05-0047.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0047/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0047
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0047
  name: test05.smol.0047.extract
  skipsolve: True
  metadata:
    job_id: "0047"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0047/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0048
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0048
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0048.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 5.848484848484849
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0048
  mesh_stem: test05-0048
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0048
  mesh: !mesh_hdf5file test05-0048.hdf5
  meshmeta: !meshmetafile test05-0048.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0048
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0048
  name: test05.smol.0048.solve
  mesh: !mesh_hdf5file test05-0048.hdf5
  meshmeta: !meshmetafile test05-0048.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0048/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0048
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0048
  name: test05.smol.0048.extract
  skipsolve: True
  metadata:
    job_id: "0048"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0048/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0049
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0049
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0049.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 5.909090909090909
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0049
  mesh_stem: test05-0049
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0049
  mesh: !mesh_hdf5file test05-0049.hdf5
  meshmeta: !meshmetafile test05-0049.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0049
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0049
  name: test05.smol.0049.solve
  mesh: !mesh_hdf5file test05-0049.hdf5
  meshmeta: !meshmetafile test05-0049.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0049/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0049
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0049
  name: test05.smol.0049.extract
  skipsolve: True
  metadata:
    job_id: "0049"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0049/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0050
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0050
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0050.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 5.96969696969697
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0050
  mesh_stem: test05-0050
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0050
  mesh: !mesh_hdf5file test05-0050.hdf5
  meshmeta: !meshmetafile test05-0050.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0050
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0050
  name: test05.smol.0050.solve
  mesh: !mesh_hdf5file test05-0050.hdf5
  meshmeta: !meshmetafile test05-0050.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0050/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0050
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0050
  name: test05.smol.0050.extract
  skipsolve: True
  metadata:
    job_id: "0050"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0050/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0051
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0051
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0051.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 6.03030303030303
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0051
  mesh_stem: test05-0051
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0051
  mesh: !mesh_hdf5file test05-0051.hdf5
  meshmeta: !meshmetafile test05-0051.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0051
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0051
  name: test05.smol.0051.solve
  mesh: !mesh_hdf5file test05-0051.hdf5
  meshmeta: !meshmetafile test05-0051.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0051/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0051
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0051
  name: test05.smol.0051.extract
  skipsolve: True
  metadata:
    job_id: "0051"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0051/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0052
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0052
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0052.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 6.090909090909091
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0052
  mesh_stem: test05-0052
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0052
  mesh: !mesh_hdf5file test05-0052.hdf5
  meshmeta: !meshmetafile test05-0052.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0052
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0052
  name: test05.smol.0052.solve
  mesh: !mesh_hdf5file test05-0052.hdf5
  meshmeta: !meshmetafile test05-0052.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0052/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0052
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0052
  name: test05.smol.0052.extract
  skipsolve: True
  metadata:
    job_id: "0052"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0052/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0053
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0053
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0053.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 6.151515151515151
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0053
  mesh_stem: test05-0053
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0053
  mesh: !mesh_hdf5file test05-0053.hdf5
  meshmeta: !meshmetafile test05-0053.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0053
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0053
  name: test05.smol.0053.solve
  mesh: !mesh_hdf5file test05-0053.hdf5
  meshmeta: !meshmetafile test05-0053.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0053/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0053
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0053
  name: test05.smol.0053.extract
  skipsolve: True
  metadata:
    job_id: "0053"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0053/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0054
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0054
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0054.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 6.212121212121213
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0054
  mesh_stem: test05-0054
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0054
  mesh: !mesh_hdf5file test05-0054.hdf5
  meshmeta: !meshmetafile test05-0054.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0054
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0054
  name: test05.smol.0054.solve
  mesh: !mesh_hdf5file test05-0054.hdf5
  meshmeta: !meshmetafile test05-0054.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0054/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0054
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0054
  name: test05.smol.0054.extract
  skipsolve: True
  metadata:
    job_id: "0054"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0054/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0055
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0055
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0055.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 6.2727272727272725
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0055
  mesh_stem: test05-0055
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0055
  mesh: !mesh_hdf5file test05-0055.hdf5
  meshmeta: !meshmetafile test05-0055.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0055
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0055
  name: test05.smol.0055.solve
  mesh: !mesh_hdf5file test05-0055.hdf5
  meshmeta: !meshmetafile test05-0055.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0055/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0055
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0055
  name: test05.smol.0055.extract
  skipsolve: True
  metadata:
    job_id: "0055"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0055/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0056
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0056
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0056.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 6.333333333333334
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0056
  mesh_stem: test05-0056
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0056
  mesh: !mesh_hdf5file test05-0056.hdf5
  meshmeta: !meshmetafile test05-0056.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0056
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0056
  name: test05.smol.0056.solve
  mesh: !mesh_hdf5file test05-0056.hdf5
  meshmeta: !meshmetafile test05-0056.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0056/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0056
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0056
  name: test05.smol.0056.extract
  skipsolve: True
  metadata:
    job_id: "0056"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0056/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0057
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0057
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0057.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 6.3939393939393945
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0057
  mesh_stem: test05-0057
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0057
  mesh: !mesh_hdf5file test05-0057.hdf5
  meshmeta: !meshmetafile test05-0057.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0057
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0057
  name: test05.smol.0057.solve
  mesh: !mesh_hdf5file test05-0057.hdf5
  meshmeta: !meshmetafile test05-0057.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0057/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0057
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0057
  name: test05.smol.0057.extract
  skipsolve: True
  metadata:
    job_id: "0057"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0057/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0058
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0058
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0058.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 6.454545454545455
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0058
  mesh_stem: test05-0058
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0058
  mesh: !mesh_hdf5file test05-0058.hdf5
  meshmeta: !meshmetafile test05-0058.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0058
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0058
  name: test05.smol.0058.solve
  mesh: !mesh_hdf5file test05-0058.hdf5
  meshmeta: !meshmetafile test05-0058.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0058/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0058
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0058
  name: test05.smol.0058.extract
  skipsolve: True
  metadata:
    job_id: "0058"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0058/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0059
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0059
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0059.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 6.5151515151515165
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0059
  mesh_stem: test05-0059
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0059
  mesh: !mesh_hdf5file test05-0059.hdf5
  meshmeta: !meshmetafile test05-0059.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0059
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0059
  name: test05.smol.0059.solve
  mesh: !mesh_hdf5file test05-0059.hdf5
  meshmeta: !meshmetafile test05-0059.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0059/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0059
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0059
  name: test05.smol.0059.extract
  skipsolve: True
  metadata:
    job_id: "0059"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0059/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0060
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0060
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0060.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 6.575757575757576
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0060
  mesh_stem: test05-0060
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0060
  mesh: !mesh_hdf5file test05-0060.hdf5
  meshmeta: !meshmetafile test05-0060.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0060
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0060
  name: test05.smol.0060.solve
  mesh: !mesh_hdf5file test05-0060.hdf5
  meshmeta: !meshmetafile test05-0060.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0060/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0060
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0060
  name: test05.smol.0060.extract
  skipsolve: True
  metadata:
    job_id: "0060"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0060/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0061
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0061
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0061.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 6.636363636363638
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0061
  mesh_stem: test05-0061
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0061
  mesh: !mesh_hdf5file test05-0061.hdf5
  meshmeta: !meshmetafile test05-0061.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0061
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0061
  name: test05.smol.0061.solve
  mesh: !mesh_hdf5file test05-0061.hdf5
  meshmeta: !meshmetafile test05-0061.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0061/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0061
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0061
  name: test05.smol.0061.extract
  skipsolve: True
  metadata:
    job_id: "0061"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0061/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0062
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0062
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0062.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 6.696969696969697
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0062
  mesh_stem: test05-0062
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0062
  mesh: !mesh_hdf5file test05-0062.hdf5
  meshmeta: !meshmetafile test05-0062.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0062
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0062
  name: test05.smol.0062.solve
  mesh: !mesh_hdf5file test05-0062.hdf5
  meshmeta: !meshmetafile test05-0062.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0062/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0062
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0062
  name: test05.smol.0062.extract
  skipsolve: True
  metadata:
    job_id: "0062"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0062/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0063
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0063
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0063.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 6.757575757575758
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0063
  mesh_stem: test05-0063
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0063
  mesh: !mesh_hdf5file test05-0063.hdf5
  meshmeta: !meshmetafile test05-0063.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0063
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0063
  name: test05.smol.0063.solve
  mesh: !mesh_hdf5file test05-0063.hdf5
  meshmeta: !meshmetafile test05-0063.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0063/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0063
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0063
  name: test05.smol.0063.extract
  skipsolve: True
  metadata:
    job_id: "0063"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0063/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0064
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0064
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0064.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 6.8181818181818175
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0064
  mesh_stem: test05-0064
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0064
  mesh: !mesh_hdf5file test05-0064.hdf5
  meshmeta: !meshmetafile test05-0064.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0064
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0064
  name: test05.smol.0064.solve
  mesh: !mesh_hdf5file test05-0064.hdf5
  meshmeta: !meshmetafile test05-0064.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0064/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0064
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0064
  name: test05.smol.0064.extract
  skipsolve: True
  metadata:
    job_id: "0064"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0064/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0065
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0065
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0065.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 6.878787878787879
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0065
  mesh_stem: test05-0065
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0065
  mesh: !mesh_hdf5file test05-0065.hdf5
  meshmeta: !meshmetafile test05-0065.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0065
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0065
  name: test05.smol.0065.solve
  mesh: !mesh_hdf5file test05-0065.hdf5
  meshmeta: !meshmetafile test05-0065.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0065/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0065
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0065
  name: test05.smol.0065.extract
  skipsolve: True
  metadata:
    job_id: "0065"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0065/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0066
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0066
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0066.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 6.9393939393939394
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0066
  mesh_stem: test05-0066
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0066
  mesh: !mesh_hdf5file test05-0066.hdf5
  meshmeta: !meshmetafile test05-0066.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0066
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0066
  name: test05.smol.0066.solve
  mesh: !mesh_hdf5file test05-0066.hdf5
  meshmeta: !meshmetafile test05-0066.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0066/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0066
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0066
  name: test05.smol.0066.extract
  skipsolve: True
  metadata:
    job_id: "0066"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0066/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0067
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0067
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0067.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 7.0
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0067
  mesh_stem: test05-0067
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0067
  mesh: !mesh_hdf5file test05-0067.hdf5
  meshmeta: !meshmetafile test05-0067.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0067
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0067
  name: test05.smol.0067.solve
  mesh: !mesh_hdf5file test05-0067.hdf5
  meshmeta: !meshmetafile test05-0067.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0067/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0067
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0067
  name: test05.smol.0067.extract
  skipsolve: True
  metadata:
    job_id: "0067"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0067/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0068
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0068
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0068.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 7.0606060606060606
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0068
  mesh_stem: test05-0068
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0068
  mesh: !mesh_hdf5file test05-0068.hdf5
  meshmeta: !meshmetafile test05-0068.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0068
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0068
  name: test05.smol.0068.solve
  mesh: !mesh_hdf5file test05-0068.hdf5
  meshmeta: !meshmetafile test05-0068.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0068/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0068
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0068
  name: test05.smol.0068.extract
  skipsolve: True
  metadata:
    job_id: "0068"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0068/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0069
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0069
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0069.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 7.121212121212121
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0069
  mesh_stem: test05-0069
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0069
  mesh: !mesh_hdf5file test05-0069.hdf5
  meshmeta: !meshmetafile test05-0069.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0069
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0069
  name: test05.smol.0069.solve
  mesh: !mesh_hdf5file test05-0069.hdf5
  meshmeta: !meshmetafile test05-0069.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0069/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0069
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0069
  name: test05.smol.0069.extract
  skipsolve: True
  metadata:
    job_id: "0069"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0069/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0070
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0070
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0070.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 7.1818181818181825
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0070
  mesh_stem: test05-0070
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0070
  mesh: !mesh_hdf5file test05-0070.hdf5
  meshmeta: !meshmetafile test05-0070.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0070
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0070
  name: test05.smol.0070.solve
  mesh: !mesh_hdf5file test05-0070.hdf5
  meshmeta: !meshmetafile test05-0070.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0070/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0070
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0070
  name: test05.smol.0070.extract
  skipsolve: True
  metadata:
    job_id: "0070"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0070/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0071
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0071
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0071.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 7.242424242424242
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0071
  mesh_stem: test05-0071
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0071
  mesh: !mesh_hdf5file test05-0071.hdf5
  meshmeta: !meshmetafile test05-0071.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0071
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0071
  name: test05.smol.0071.solve
  mesh: !mesh_hdf5file test05-0071.hdf5
  meshmeta: !meshmetafile test05-0071.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0071/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0071
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0071
  name: test05.smol.0071.extract
  skipsolve: True
  metadata:
    job_id: "0071"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0071/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0072
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0072
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0072.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 7.303030303030303
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0072
  mesh_stem: test05-0072
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0072
  mesh: !mesh_hdf5file test05-0072.hdf5
  meshmeta: !meshmetafile test05-0072.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0072
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0072
  name: test05.smol.0072.solve
  mesh: !mesh_hdf5file test05-0072.hdf5
  meshmeta: !meshmetafile test05-0072.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0072/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0072
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0072
  name: test05.smol.0072.extract
  skipsolve: True
  metadata:
    job_id: "0072"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0072/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0073
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0073
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0073.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 7.363636363636362
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0073
  mesh_stem: test05-0073
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0073
  mesh: !mesh_hdf5file test05-0073.hdf5
  meshmeta: !meshmetafile test05-0073.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0073
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0073
  name: test05.smol.0073.solve
  mesh: !mesh_hdf5file test05-0073.hdf5
  meshmeta: !meshmetafile test05-0073.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0073/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0073
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0073
  name: test05.smol.0073.extract
  skipsolve: True
  metadata:
    job_id: "0073"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0073/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0074
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0074
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0074.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 7.424242424242425
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0074
  mesh_stem: test05-0074
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0074
  mesh: !mesh_hdf5file test05-0074.hdf5
  meshmeta: !meshmetafile test05-0074.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0074
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0074
  name: test05.smol.0074.solve
  mesh: !mesh_hdf5file test05-0074.hdf5
  meshmeta: !meshmetafile test05-0074.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0074/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0074
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0074
  name: test05.smol.0074.extract
  skipsolve: True
  metadata:
    job_id: "0074"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0074/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0075
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0075
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0075.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 7.484848484848485
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0075
  mesh_stem: test05-0075
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0075
  mesh: !mesh_hdf5file test05-0075.hdf5
  meshmeta: !meshmetafile test05-0075.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0075
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0075
  name: test05.smol.0075.solve
  mesh: !mesh_hdf5file test05-0075.hdf5
  meshmeta: !meshmetafile test05-0075.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0075/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0075
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0075
  name: test05.smol.0075.extract
  skipsolve: True
  metadata:
    job_id: "0075"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0075/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0076
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0076
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0076.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 7.545454545454546
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0076
  mesh_stem: test05-0076
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0076
  mesh: !mesh_hdf5file test05-0076.hdf5
  meshmeta: !meshmetafile test05-0076.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0076
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0076
  name: test05.smol.0076.solve
  mesh: !mesh_hdf5file test05-0076.hdf5
  meshmeta: !meshmetafile test05-0076.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0076/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0076
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0076
  name: test05.smol.0076.extract
  skipsolve: True
  metadata:
    job_id: "0076"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0076/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0077
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0077
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0077.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 7.606060606060606
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0077
  mesh_stem: test05-0077
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0077
  mesh: !mesh_hdf5file test05-0077.hdf5
  meshmeta: !meshmetafile test05-0077.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0077
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0077
  name: test05.smol.0077.solve
  mesh: !mesh_hdf5file test05-0077.hdf5
  meshmeta: !meshmetafile test05-0077.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0077/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0077
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0077
  name: test05.smol.0077.extract
  skipsolve: True
  metadata:
    job_id: "0077"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0077/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0078
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0078
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0078.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 7.666666666666668
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0078
  mesh_stem: test05-0078
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0078
  mesh: !mesh_hdf5file test05-0078.hdf5
  meshmeta: !meshmetafile test05-0078.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0078
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0078
  name: test05.smol.0078.solve
  mesh: !mesh_hdf5file test05-0078.hdf5
  meshmeta: !meshmetafile test05-0078.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0078/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0078
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0078
  name: test05.smol.0078.extract
  skipsolve: True
  metadata:
    job_id: "0078"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0078/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0079
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0079
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0079.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 7.727272727272727
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0079
  mesh_stem: test05-0079
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0079
  mesh: !mesh_hdf5file test05-0079.hdf5
  meshmeta: !meshmetafile test05-0079.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0079
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0079
  name: test05.smol.0079.solve
  mesh: !mesh_hdf5file test05-0079.hdf5
  meshmeta: !meshmetafile test05-0079.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0079/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0079
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0079
  name: test05.smol.0079.extract
  skipsolve: True
  metadata:
    job_id: "0079"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0079/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0080
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0080
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0080.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 7.787878787878787
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0080
  mesh_stem: test05-0080
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0080
  mesh: !mesh_hdf5file test05-0080.hdf5
  meshmeta: !meshmetafile test05-0080.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0080
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0080
  name: test05.smol.0080.solve
  mesh: !mesh_hdf5file test05-0080.hdf5
  meshmeta: !meshmetafile test05-0080.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0080/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0080
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0080
  name: test05.smol.0080.extract
  skipsolve: True
  metadata:
    job_id: "0080"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0080/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0081
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0081
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0081.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 7.848484848484849
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0081
  mesh_stem: test05-0081
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0081
  mesh: !mesh_hdf5file test05-0081.hdf5
  meshmeta: !meshmetafile test05-0081.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0081
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0081
  name: test05.smol.0081.solve
  mesh: !mesh_hdf5file test05-0081.hdf5
  meshmeta: !meshmetafile test05-0081.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0081/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0081
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0081
  name: test05.smol.0081.extract
  skipsolve: True
  metadata:
    job_id: "0081"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0081/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0082
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0082
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0082.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 7.909090909090909
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0082
  mesh_stem: test05-0082
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0082
  mesh: !mesh_hdf5file test05-0082.hdf5
  meshmeta: !meshmetafile test05-0082.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0082
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0082
  name: test05.smol.0082.solve
  mesh: !mesh_hdf5file test05-0082.hdf5
  meshmeta: !meshmetafile test05-0082.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0082/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0082
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0082
  name: test05.smol.0082.extract
  skipsolve: True
  metadata:
    job_id: "0082"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0082/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0083
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0083
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0083.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 7.96969696969697
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0083
  mesh_stem: test05-0083
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0083
  mesh: !mesh_hdf5file test05-0083.hdf5
  meshmeta: !meshmetafile test05-0083.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0083
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0083
  name: test05.smol.0083.solve
  mesh: !mesh_hdf5file test05-0083.hdf5
  meshmeta: !meshmetafile test05-0083.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0083/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0083
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0083
  name: test05.smol.0083.extract
  skipsolve: True
  metadata:
    job_id: "0083"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0083/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0084
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0084
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0084.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 8.030303030303031
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0084
  mesh_stem: test05-0084
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0084
  mesh: !mesh_hdf5file test05-0084.hdf5
  meshmeta: !meshmetafile test05-0084.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0084
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0084
  name: test05.smol.0084.solve
  mesh: !mesh_hdf5file test05-0084.hdf5
  meshmeta: !meshmetafile test05-0084.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0084/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0084
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0084
  name: test05.smol.0084.extract
  skipsolve: True
  metadata:
    job_id: "0084"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0084/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0085
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0085
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0085.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 8.09090909090909
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0085
  mesh_stem: test05-0085
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0085
  mesh: !mesh_hdf5file test05-0085.hdf5
  meshmeta: !meshmetafile test05-0085.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0085
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0085
  name: test05.smol.0085.solve
  mesh: !mesh_hdf5file test05-0085.hdf5
  meshmeta: !meshmetafile test05-0085.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0085/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0085
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0085
  name: test05.smol.0085.extract
  skipsolve: True
  metadata:
    job_id: "0085"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0085/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0086
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0086
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0086.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 8.151515151515152
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0086
  mesh_stem: test05-0086
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0086
  mesh: !mesh_hdf5file test05-0086.hdf5
  meshmeta: !meshmetafile test05-0086.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0086
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0086
  name: test05.smol.0086.solve
  mesh: !mesh_hdf5file test05-0086.hdf5
  meshmeta: !meshmetafile test05-0086.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0086/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0086
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0086
  name: test05.smol.0086.extract
  skipsolve: True
  metadata:
    job_id: "0086"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0086/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0087
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0087
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0087.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 8.212121212121211
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0087
  mesh_stem: test05-0087
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0087
  mesh: !mesh_hdf5file test05-0087.hdf5
  meshmeta: !meshmetafile test05-0087.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0087
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0087
  name: test05.smol.0087.solve
  mesh: !mesh_hdf5file test05-0087.hdf5
  meshmeta: !meshmetafile test05-0087.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0087/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0087
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0087
  name: test05.smol.0087.extract
  skipsolve: True
  metadata:
    job_id: "0087"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0087/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0088
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0088
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0088.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 8.272727272727273
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0088
  mesh_stem: test05-0088
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0088
  mesh: !mesh_hdf5file test05-0088.hdf5
  meshmeta: !meshmetafile test05-0088.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0088
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0088
  name: test05.smol.0088.solve
  mesh: !mesh_hdf5file test05-0088.hdf5
  meshmeta: !meshmetafile test05-0088.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0088/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0088
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0088
  name: test05.smol.0088.extract
  skipsolve: True
  metadata:
    job_id: "0088"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0088/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0089
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0089
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0089.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 8.333333333333334
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0089
  mesh_stem: test05-0089
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0089
  mesh: !mesh_hdf5file test05-0089.hdf5
  meshmeta: !meshmetafile test05-0089.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0089
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0089
  name: test05.smol.0089.solve
  mesh: !mesh_hdf5file test05-0089.hdf5
  meshmeta: !meshmetafile test05-0089.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0089/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0089
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0089
  name: test05.smol.0089.extract
  skipsolve: True
  metadata:
    job_id: "0089"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0089/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0090
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0090
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0090.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 8.393939393939394
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0090
  mesh_stem: test05-0090
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0090
  mesh: !mesh_hdf5file test05-0090.hdf5
  meshmeta: !meshmetafile test05-0090.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0090
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0090
  name: test05.smol.0090.solve
  mesh: !mesh_hdf5file test05-0090.hdf5
  meshmeta: !meshmetafile test05-0090.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0090/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0090
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0090
  name: test05.smol.0090.extract
  skipsolve: True
  metadata:
    job_id: "0090"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0090/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0091
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0091
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0091.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 8.454545454545455
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0091
  mesh_stem: test05-0091
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0091
  mesh: !mesh_hdf5file test05-0091.hdf5
  meshmeta: !meshmetafile test05-0091.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0091
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0091
  name: test05.smol.0091.solve
  mesh: !mesh_hdf5file test05-0091.hdf5
  meshmeta: !meshmetafile test05-0091.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0091/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0091
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0091
  name: test05.smol.0091.extract
  skipsolve: True
  metadata:
    job_id: "0091"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0091/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0092
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0092
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0092.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 8.515151515151516
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0092
  mesh_stem: test05-0092
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0092
  mesh: !mesh_hdf5file test05-0092.hdf5
  meshmeta: !meshmetafile test05-0092.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0092
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0092
  name: test05.smol.0092.solve
  mesh: !mesh_hdf5file test05-0092.hdf5
  meshmeta: !meshmetafile test05-0092.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0092/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0092
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0092
  name: test05.smol.0092.extract
  skipsolve: True
  metadata:
    job_id: "0092"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0092/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0093
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0093
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0093.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 8.575757575757576
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0093
  mesh_stem: test05-0093
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0093
  mesh: !mesh_hdf5file test05-0093.hdf5
  meshmeta: !meshmetafile test05-0093.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0093
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0093
  name: test05.smol.0093.solve
  mesh: !mesh_hdf5file test05-0093.hdf5
  meshmeta: !meshmetafile test05-0093.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0093/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0093
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0093
  name: test05.smol.0093.extract
  skipsolve: True
  metadata:
    job_id: "0093"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0093/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0094
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0094
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0094.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 8.636363636363637
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0094
  mesh_stem: test05-0094
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0094
  mesh: !mesh_hdf5file test05-0094.hdf5
  meshmeta: !meshmetafile test05-0094.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0094
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0094
  name: test05.smol.0094.solve
  mesh: !mesh_hdf5file test05-0094.hdf5
  meshmeta: !meshmetafile test05-0094.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0094/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0094
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0094
  name: test05.smol.0094.extract
  skipsolve: True
  metadata:
    job_id: "0094"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0094/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0095
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0095
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0095.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 8.696969696969697
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0095
  mesh_stem: test05-0095
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0095
  mesh: !mesh_hdf5file test05-0095.hdf5
  meshmeta: !meshmetafile test05-0095.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0095
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0095
  name: test05.smol.0095.solve
  mesh: !mesh_hdf5file test05-0095.hdf5
  meshmeta: !meshmetafile test05-0095.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0095/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0095
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0095
  name: test05.smol.0095.extract
  skipsolve: True
  metadata:
    job_id: "0095"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0095/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0096
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0096
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0096.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 8.757575757575758
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0096
  mesh_stem: test05-0096
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0096
  mesh: !mesh_hdf5file test05-0096.hdf5
  meshmeta: !meshmetafile test05-0096.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0096
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0096
  name: test05.smol.0096.solve
  mesh: !mesh_hdf5file test05-0096.hdf5
  meshmeta: !meshmetafile test05-0096.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0096/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0096
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0096
  name: test05.smol.0096.extract
  skipsolve: True
  metadata:
    job_id: "0096"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0096/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0097
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0097
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0097.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 8.818181818181818
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0097
  mesh_stem: test05-0097
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0097
  mesh: !mesh_hdf5file test05-0097.hdf5
  meshmeta: !meshmetafile test05-0097.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0097
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0097
  name: test05.smol.0097.solve
  mesh: !mesh_hdf5file test05-0097.hdf5
  meshmeta: !meshmetafile test05-0097.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0097/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0097
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0097
  name: test05.smol.0097.extract
  skipsolve: True
  metadata:
    job_id: "0097"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0097/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0098
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0098
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0098.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 8.878787878787879
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0098
  mesh_stem: test05-0098
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0098
  mesh: !mesh_hdf5file test05-0098.hdf5
  meshmeta: !meshmetafile test05-0098.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0098
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0098
  name: test05.smol.0098.solve
  mesh: !mesh_hdf5file test05-0098.hdf5
  meshmeta: !meshmetafile test05-0098.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0098/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0098
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0098
  name: test05.smol.0098.extract
  skipsolve: True
  metadata:
    job_id: "0098"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0098/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0099
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0099
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0099.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 8.93939393939394
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0099
  mesh_stem: test05-0099
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0099
  mesh: !mesh_hdf5file test05-0099.hdf5
  meshmeta: !meshmetafile test05-0099.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0099
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0099
  name: test05.smol.0099.solve
  mesh: !mesh_hdf5file test05-0099.hdf5
  meshmeta: !meshmetafile test05-0099.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0099/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0099
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0099
  name: test05.smol.0099.extract
  skipsolve: True
  metadata:
    job_id: "0099"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0099/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]
#id=0100
#Mesh Generation
- !TemplateFileRequest
  name: test05.geo.0100
  tmplfile: !geotemplate slot2d_inclusions.geo.jinja2
  outfile: !geofile test05-0100.geo
  modules:
    - !modulefile mesh.py
  methods:
    get_template_input: mesh_get_template_input
  data:
    mcar1: 5.0
    mcar2: 2.0
    mcar3: 1.0
    mcar4: 0.2
    S: 12.0
    d: 9.0
    H: 40.0
    slot_length: 90.0
    inclusionlist: #[id, x, y, radius]
      - [1000,-20.0,0.0,1.0]
      - [1100,20.0,0.0,1.0]
    lattice:
      incrad: 0.75 #Radius of the generated inclusions, nm
      minsep: 1000.0 #Minimum separation distance (surface-to-surface), nm
      inc_id_start: 2000 #ID number for the first generated inclusion
      inc_id_step: 100 #Change in ID number between generated inclusions
      perturbation_rounds: 10
      perturbation_stdev: 0.1
- !GeoToHDF5Request
  name: test05.mesh.0100
  mesh_stem: test05-0100
#Solve the Linearized Poisson-Boltzmann Equation
- !LPBSimulator
  name: test05.lpb.0100
  mesh: !mesh_hdf5file test05-0100.hdf5
  meshmeta: !meshmetafile test05-0100.yaml
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  conditions:
    elementorder: 2
    kappa: 1.0
    dirichlet: &potential_dirichlet_0100
      1: 0.0 #Left boundary
      2: -0.025 #Right boundary
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile potential.pvd}]
    - [writefield, {outfpath: !OwnSolutionFile potential.hdf5, outname: potential}]
    - - reportvalues
      - outfpath: !OwnSolutionFile lpb_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Solve the Smoluchowski Equation
- !SUSimulator
  &smol_basic_def_0100
  name: test05.smol.0100.solve
  mesh: !mesh_hdf5file test05-0100.hdf5
  meshmeta: !meshmetafile test05-0100.yaml
  modules:
    - !modulefile simcalcs.py
  methods:
    - calc_ratio
    - calc_delta
    - effective_D
    - free_volume_fraction
  solver_parameters:
    linear_solver: gmres
    preconditioner: ilu
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0100/potential.hdf5, fieldtag: potential}]
  conditions:
    elementorder: 2
    dirichlet:
      1: [1.0] #Left boundary
      2: [0.0] #Right boundary
    species:
      - {symbol: A, z: 1.0, D: 0.008}
    beta: 1.0
    potential_dirichlet: *potential_dirichlet_0100
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile soln.hdf5, attrpath: soln, outname: soln}]
    - [transform_back, {}]
    - [calcflux, {solnattr: solnlist, idx: 0, attrpath: flux_A}]
    - [writefield, {outfpath: !OwnSolutionFile conc_A.hdf5, attrpath: clist, idx: 0, outname: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.hdf5, attrpath: flux_A, outname: flux_A}]
    - - reportvalues
      - outfpath: !OwnSolutionFile smol_solvetime.yaml
        mapping:
          elapsed_time: sim_timer.delta_str
#Extract the data
- !SUSimulator
  <<: *smol_basic_def_0100
  name: test05.smol.0100.extract
  skipsolve: True
  metadata:
    job_id: "0100"
    minsep: 1000.0
  loaddata:
    - [loadfield, {attrpath: potential, infpath: !SiblingSolutionFile lpb/0100/potential.hdf5, fieldtag: potential}]
    - [loadfield, {attrpath: soln, infpath: !OwnSolutionFile soln.hdf5, fieldtag: soln}]
    - [newfunction, {attrpath: conc_A, spaceattr: V_scalar, funcname: conc_A}]
    - [newfunction, {attrpath: flux_A, spaceattr: V_vec, funcname: flux_A}]
    - [loadfield, {attrpath: conc_A, infpath: !OwnSolutionFile conc_A.hdf5, fieldtag: conc_A}]
    - [loadfield, {attrpath: flux_A, infpath: !OwnSolutionFile flux_A.hdf5, fieldtag: flux_A}]
  dataextraction:
    - [writefield, {outfpath: !OwnSolutionFile conc_A.pvd, attrpath: conc_A}]
    - [writefield, {outfpath: !OwnSolutionFile flux_A.pvd, attrpath: flux_A}]
    - [fluxintegral, {fluxattr: flux_A, pfacet: 5, attrpath: totflux_A_pore, internal: True, fluxsign: '-'}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X1, vmax: !Stored meshinfo.metadata.X5, outattr: cell_delta_x}]
    - [calc_delta, {vmin: !Stored meshinfo.metadata.X2, vmax: !Stored meshinfo.metadata.X4, outattr: slot_delta_x}]
    - [facet_area, {pfacet: 5, attrpath: area_mid, internal: True}]
    - [facet_integral, {pfacet: 3, attrpath: int_conc_left, funcpath: conc_A, internal: True}]
    - [facet_integral, {pfacet: 4, attrpath: int_conc_right, funcpath: conc_A, internal: True}]
    - [calc_ratio, {numerator: !Stored int_conc_left, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_left}]
    - [calc_ratio, {numerator: !Stored int_conc_right, denominator: !Stored meshinfo.metadata.d, outattr: avg_conc_right}]
    - - effective_D
      - outattr: Deff_membrane #The effective diffusion coefficient of the membrane
        fluxattr: totflux_A_pore
        areaattr: [meshinfo, metadata, S]
        start_conc_attr: avg_conc_left #[conditions, dirichlet, 1, 0]
        end_conc_attr: avg_conc_right #[conditions, dirichlet, 2, 0]
        delta_s_attr: slot_delta_x #cell_delta_x
    - - effective_D
      - outattr: Deff_slot #The effective diffusion coefficient for the slot itself
        fluxattr: totflux_A_pore
        areaattr: area_mid #[meshinfo, metadata, d]
        start_conc_attr: avg_conc_left
        end_conc_attr: avg_conc_right
        delta_s_attr: slot_delta_x
    - - free_volume_fraction
      - outattr: phi_membrane
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.S]
    - - free_volume_fraction
      - outattr: phi_slot
        pcells: [3, 4]
        dimensions: [!Stored meshinfo.metadata.slot_length, !Stored meshinfo.metadata.d]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1000, attrpath: totflux_A_1000}]
    # - [fluxintegral, {fluxattr: flux_A, pfacet: 1100, attrpath: totflux_A_1100}]
    - - reportvalues
      - outfpath: !OwnSolutionFile info.yaml
        mapping:
          job_id: metadata.job_id
          minsep: metadata.minsep
          totflux_A_pore: totflux_A_pore
          # totflux_A_1000: totflux_A_1000
          # totflux_A_1100: totflux_A_1100
          elapsed_time: sim_timer.delta_str
          D_bulk_A: [conditions, species, 0, D]
          left_conc_A: [conditions, dirichlet, 1, 0]
          right_conc_A: [conditions, dirichlet, 2, 0]
          cell_delta_x: cell_delta_x
          area_mid: area_mid
          Deff_membrane: Deff_membrane
          Deff_slot: Deff_slot
          full_area: [meshinfo, metadata, S]
          avg_conc_left: avg_conc_left
          avg_conc_right: avg_conc_right
          phi_membrane: phi_membrane
          phi_slot: phi_slot
    - [new_odict, {dpath: plots}]
    - [line_profile, {startloc: [X1,Y3], endloc: [X5,Y3], num: 1000, indep: 0, plotpath: plots.CL_A, label: 'concentration of A along centerline', attrpath: conc_A}]
    - [save_pickle, {attrpath: plots, outfpath: !OwnSolutionFile plots.pkl}]

# Collection
- !RawCollectionRequest
  name: test05.collection
  outpath: !postprocfile results.pkl
  calculations:
    - [save_csv, {attrpath: df, outfpath: !postprocfile results.csv, dtype_csv_fpath: !postprocfile results_dtypes.csv}]
  definitions:
    - mapping:
        job_id: job_id
        minsep: minsep
        Deff_membrane: Deff_membrane
        Deff_slot: Deff_slot
        phi_membrane: phi_membrane
        phi_slot: phi_slot
      file_list:
        - !DataFile solutions/test05/smol/0001/info.yaml
        - !DataFile solutions/test05/smol/0002/info.yaml
        - !DataFile solutions/test05/smol/0003/info.yaml
        - !DataFile solutions/test05/smol/0004/info.yaml
        - !DataFile solutions/test05/smol/0005/info.yaml
        - !DataFile solutions/test05/smol/0006/info.yaml
        - !DataFile solutions/test05/smol/0007/info.yaml
        - !DataFile solutions/test05/smol/0008/info.yaml
        - !DataFile solutions/test05/smol/0009/info.yaml
        - !DataFile solutions/test05/smol/0010/info.yaml
        - !DataFile solutions/test05/smol/0011/info.yaml
        - !DataFile solutions/test05/smol/0012/info.yaml
        - !DataFile solutions/test05/smol/0013/info.yaml
        - !DataFile solutions/test05/smol/0014/info.yaml
        - !DataFile solutions/test05/smol/0015/info.yaml
        - !DataFile solutions/test05/smol/0016/info.yaml
        - !DataFile solutions/test05/smol/0017/info.yaml
        - !DataFile solutions/test05/smol/0018/info.yaml
        - !DataFile solutions/test05/smol/0019/info.yaml
        - !DataFile solutions/test05/smol/0020/info.yaml
        - !DataFile solutions/test05/smol/0021/info.yaml
        - !DataFile solutions/test05/smol/0022/info.yaml
        - !DataFile solutions/test05/smol/0023/info.yaml
        - !DataFile solutions/test05/smol/0024/info.yaml
        - !DataFile solutions/test05/smol/0025/info.yaml
        - !DataFile solutions/test05/smol/0026/info.yaml
        - !DataFile solutions/test05/smol/0027/info.yaml
        - !DataFile solutions/test05/smol/0028/info.yaml
        - !DataFile solutions/test05/smol/0029/info.yaml
        - !DataFile solutions/test05/smol/0030/info.yaml
        - !DataFile solutions/test05/smol/0031/info.yaml
        - !DataFile solutions/test05/smol/0032/info.yaml
        - !DataFile solutions/test05/smol/0033/info.yaml
        - !DataFile solutions/test05/smol/0034/info.yaml
        - !DataFile solutions/test05/smol/0035/info.yaml
        - !DataFile solutions/test05/smol/0036/info.yaml
        - !DataFile solutions/test05/smol/0037/info.yaml
        - !DataFile solutions/test05/smol/0038/info.yaml
        - !DataFile solutions/test05/smol/0039/info.yaml
        - !DataFile solutions/test05/smol/0040/info.yaml
        - !DataFile solutions/test05/smol/0041/info.yaml
        - !DataFile solutions/test05/smol/0042/info.yaml
        - !DataFile solutions/test05/smol/0043/info.yaml
        - !DataFile solutions/test05/smol/0044/info.yaml
        - !DataFile solutions/test05/smol/0045/info.yaml
        - !DataFile solutions/test05/smol/0046/info.yaml
        - !DataFile solutions/test05/smol/0047/info.yaml
        - !DataFile solutions/test05/smol/0048/info.yaml
        - !DataFile solutions/test05/smol/0049/info.yaml
        - !DataFile solutions/test05/smol/0050/info.yaml
        - !DataFile solutions/test05/smol/0051/info.yaml
        - !DataFile solutions/test05/smol/0052/info.yaml
        - !DataFile solutions/test05/smol/0053/info.yaml
        - !DataFile solutions/test05/smol/0054/info.yaml
        - !DataFile solutions/test05/smol/0055/info.yaml
        - !DataFile solutions/test05/smol/0056/info.yaml
        - !DataFile solutions/test05/smol/0057/info.yaml
        - !DataFile solutions/test05/smol/0058/info.yaml
        - !DataFile solutions/test05/smol/0059/info.yaml
        - !DataFile solutions/test05/smol/0060/info.yaml
        - !DataFile solutions/test05/smol/0061/info.yaml
        - !DataFile solutions/test05/smol/0062/info.yaml
        - !DataFile solutions/test05/smol/0063/info.yaml
        - !DataFile solutions/test05/smol/0064/info.yaml
        - !DataFile solutions/test05/smol/0065/info.yaml
        - !DataFile solutions/test05/smol/0066/info.yaml
        - !DataFile solutions/test05/smol/0067/info.yaml
        - !DataFile solutions/test05/smol/0068/info.yaml
        - !DataFile solutions/test05/smol/0069/info.yaml
        - !DataFile solutions/test05/smol/0070/info.yaml
        - !DataFile solutions/test05/smol/0071/info.yaml
        - !DataFile solutions/test05/smol/0072/info.yaml
        - !DataFile solutions/test05/smol/0073/info.yaml
        - !DataFile solutions/test05/smol/0074/info.yaml
        - !DataFile solutions/test05/smol/0075/info.yaml
        - !DataFile solutions/test05/smol/0076/info.yaml
        - !DataFile solutions/test05/smol/0077/info.yaml
        - !DataFile solutions/test05/smol/0078/info.yaml
        - !DataFile solutions/test05/smol/0079/info.yaml
        - !DataFile solutions/test05/smol/0080/info.yaml
        - !DataFile solutions/test05/smol/0081/info.yaml
        - !DataFile solutions/test05/smol/0082/info.yaml
        - !DataFile solutions/test05/smol/0083/info.yaml
        - !DataFile solutions/test05/smol/0084/info.yaml
        - !DataFile solutions/test05/smol/0085/info.yaml
        - !DataFile solutions/test05/smol/0086/info.yaml
        - !DataFile solutions/test05/smol/0087/info.yaml
        - !DataFile solutions/test05/smol/0088/info.yaml
        - !DataFile solutions/test05/smol/0089/info.yaml
        - !DataFile solutions/test05/smol/0090/info.yaml
        - !DataFile solutions/test05/smol/0091/info.yaml
        - !DataFile solutions/test05/smol/0092/info.yaml
        - !DataFile solutions/test05/smol/0093/info.yaml
        - !DataFile solutions/test05/smol/0094/info.yaml
        - !DataFile solutions/test05/smol/0095/info.yaml
        - !DataFile solutions/test05/smol/0096/info.yaml
        - !DataFile solutions/test05/smol/0097/info.yaml
        - !DataFile solutions/test05/smol/0098/info.yaml
        - !DataFile solutions/test05/smol/0099/info.yaml
        - !DataFile solutions/test05/smol/0100/info.yaml

# Plotting
- !FigureRequest
  name: test05.plot
  #loadfiles:
  #  dframe: !postprocfile results.pkl #We can't load the dtypes this way.
  prepcommands:
    - [load_csv, {infpath: !postprocfile results.csv, attrpath: dframe, dtype_csv_fpath: !postprocfile results_dtypes.csv}]
    - [series_from_dataframe, {dfpath: dframe, xcol: minsep, ycol: Deff_membrane, outattr: series_1, label: "$D_{eff}$"}]
  rcparams:
    figure.dpi: 300
    figure.autolayout: False
  figures:
    - !FigureProperties
      figsize: [8,5]
      outfpath: !postprocfile plot.png
  axes:
    - !AxesProperties
      xlabel:
        xlabel: 'Minimum separation distance [nm]'
        fontsize: 20
      ylabel:
        ylabel: '$D_{eff}$'
        fontsize: 20
      #xlim: [30,60]
      ylim: [0.0,1.0]
  series:
    - !SeriesProperties
      seriesattr: series_1
      fmt: "ko"
  plotcommands:
    - [axmethod, {method: legend, loc: "center left", numpoints: 1, bbox_to_anchor: [1, 0.5]}] 
    #- [figmethod, {method: subplots_adjust, bottom: 0.15, left: 0.1, right: 0.7}]
